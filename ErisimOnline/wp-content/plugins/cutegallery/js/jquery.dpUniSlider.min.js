(function(a){function b(b,c){this.slider=a(b);this.settings=a.extend({},a.fn.dpUniSlider.defaults,c);this.$container=a(this.slider).css("position","relative"),this.isIE=a.browser.msie&&a.browser.version<9,this.$slides=a("> li",this.$container),this.slidesTotal=this.$slides.length,this.animateTimer=null,this.windowWidth=a(window).width(),this.$currentSlide=this.$slides.eq("0"),this.currentSlideNum=this.settings.preselectSlideNum>0?this.settings.preselectSlideNum-1:0,this.firstSlide=true,this.arrowsHeight=0,this.outerHeight=0,this.$pauseHoverElement="",this.$autoLoader_icon="",this.$nextSlide=a(),this.no_draggable=false,this.hasTouch=false,this.downEvent="mousedown.rs",this.moveEvent="mousemove.rs",this.upEvent="mouseup.rs",this.isDragging=false,this.successfullyDragged=false,this.startTime=0,this.startMouseX=0,this.startMouseY=0,this.currentDragPosition=0,this.lastDragPosition=0,this.accelerationX=0,this.tx=0;if("ontouchstart"in window){this.hasTouch=true;this.downEvent="touchstart.rs";this.moveEvent="touchmove.rs";this.upEvent="touchend.rs"}this.init()}b.prototype={init:function(){var b=this;if(!this.isIE){this.$slides.css({position:"absolute",top:"0",left:"0",opacity:"0",zIndex:"3",visibility:"hidden",display:"block"})}else{this.$slides.css({position:"absolute",top:"0",left:this.windowWidth,zIndex:"3",display:"block"})}this.goToSlide(this.currentSlideNum);$wrapper=a("<div />").addClass("dpUniSlider_wrapper");a(this.$container).before($wrapper);$wrapper.append(a(this.$container));this.$pauseHoverElement=$wrapper;this.$container.css("height",this.$currentSlide.innerHeight());this.$container.addClass("dpUniSlider_container");this.$slides.addClass("dpUniSlider_slide");this.$slides.each(this._manageSlides);if(this.settings.showArrows){var c=a("<a />").addClass("dpUniSlider_larrow").attr({href:"#"}),d=a("<a />").addClass("dpUniSlider_rarrow").attr({href:"#"});this.$container.parent().append(c);this.$container.parent().append(d);this.arrowsHeight=c.height();a(c).click(function(a){a.preventDefault();b._leftArrowActions(b)});a(d).click(function(a){a.preventDefault();b._rightArrowActions(b)});if(!this.isIE){a(".dpUniSlider_larrow, .dpUniSlider_rarrow",this.$container.parent()).hover(function(){a(this).stop(true,true).fadeTo("fast",.5)},function(){a(this).stop(true,true).fadeTo("fast",.9)})}if(this.slidesTotal!==1)a(".dpUniSlider_larrow, .dpUniSlider_rarrow",this.$container.parent()).show()}if(this.settings.showNavigation){var e=a("<ul />").addClass("dpUniSlider_nav");for(var f=1;f<=this.$slides.length;f++){this._createNavigation(f,e,b)}if(!this.isIE){a(e).hover(function(){a(this).stop(true,true).fadeTo("fast",.8)},function(){a(this).stop(true,true).fadeTo("fast",.9)})}this.$container.parent().append(e);a(this.$container.parent().find("ul.dpUniSlider_nav li")[this.currentSlideNum]).addClass("active");if(this.slidesTotal!==1){a(e).show();if(this.settings.navPosition==""){this.settings.navPosition="bottom-center"}if(this.settings.navPosition=="top-center"||this.settings.navPosition=="bottom-center"){a(e).css({marginLeft:-(e.outerWidth()/2)+"px"})}if(this.settings.navPosition=="top-left"||this.settings.navPosition=="bottom-left"){a(e).css({left:"10px"})}if(this.settings.navPosition=="top-right"||this.settings.navPosition=="bottom-right"){a(e).css({right:"10px",left:"auto"})}if(this.settings.navPosition=="top-right"||this.settings.navPosition=="top-center"||this.settings.navPosition=="top-left"){a(e).css({bottom:"auto",top:"10px"})}}}this.setAutoAnimation();if(this.settings.autoSlide&&!this.$pauseHoverElement.find(".dpUniSlider_autoLoader").length&&this.settings.showAutoSlideIcon){this.$autoLoader_icon=a("<div />").addClass("dpUniSlider_autoLoader");this.$pauseHoverElement.append(this.$autoLoader_icon);this.$autoLoader_icon.stop().fadeIn("fast")}if(this.slidesTotal!==1&&this.settings.draggable){this.$container.addClass("isDraggable");this.$container.bind(this.downEvent,function(a){if(!this.no_draggable){b.startDrag(a)}else if(!b.hasTouch){a.preventDefault()}})}},_manageSlides:function(b){var c=a(this).find("img[data-unislider-type='background']");if(c.length){a(this).css({backgroundImage:"url("+c.attr("src")+")"});c.remove()}var d=a(this).find("span[data-unislider-type='caption']");if(d.length){caption_position=typeof a(d).data("unislider-position")!=="undefined"?a(d).data("unislider-position"):"top-center";var e=a("<span />").addClass("dpUniSlider_caption").html(d.html());a(this).append(e);d.remove();if(caption_position=="top-center"||caption_position=="bottom-center"){e.css({marginLeft:-(e.outerWidth()/2)+"px"})}if(caption_position=="top-left"||caption_position=="bottom-left"){e.css({left:"10px"})}if(caption_position=="top-right"||caption_position=="bottom-right"){e.css({right:"10px",left:"auto"})}if(caption_position=="bottom-right"||caption_position=="bottom-center"||caption_position=="bottom-left"){e.css({bottom:"10px",top:"auto"})}}},_leftArrowActions:function(a){a.clearAutoTimer();a.goToSlide(a.currentSlideNum-1);return false},_rightArrowActions:function(a){a.clearAutoTimer();a.goToSlide(a.currentSlideNum+1);return false},_createNavigation:function(b,c,d){c.append(a("<li />").click(function(){d.goToSlide(b-1)}))},goToSlide:function(c,d,e){if(d&&this.settings.pauseOnHover&&this.$pauseHoverElement.is(".dpUniSlider_ishovered")){this.clearAutoTimer();this.setAutoAnimation();return}var f=this.currentSlideNum-c,g=this.settings.startOffset*f,h=this.settings.endOffset*f,i=this.windowWidth*f+this.settings.slideOpacity*-f,j=this.windowWidth*f,k=!this.isIE?{left:i+"px",opacity:"0"}:{left:i+"px"},l=!this.isIE?{left:h+"px",opacity:"1"}:{left:h+"px"},m=false;if(f>0){if(typeof this.settings.onSlidePrev==="function"&&!this.firstSlide){this.settings.onSlidePrev(c+1)}}else{if(typeof this.settings.onSlideNext==="function"&&!this.firstSlide){this.settings.onSlideNext(c+1)}}if(!this.settings.loop){if(c+1==this.slidesTotal&&this.settings.autoSlide){this.clearAutoTimer()}if(c+1>this.slidesTotal){return}if(this.slidesTotal-1==c){a(".dpUniSlider_rarrow",this.$container.parent()).hide().height(0);m=true}else{a(".dpUniSlider_rarrow",this.$container.parent()).height(this.arrowsHeight).show()}c==0?a(".dpUniSlider_larrow",this.$container.parent()).hide().height(0):a(".dpUniSlider_larrow",this.$container.parent()).height(this.arrowsHeight).show()}if(c<0)c=this.slidesTotal-1;if(c>=this.slidesTotal)c=0;this.currentSlideNum=c;this.$nextSlide=this.$slides.eq(c);if(this.settings.showNavigation){a(this.$container.parent().find("ul.dpUniSlider_nav li")).removeClass("active");a(this.$container.parent().find("ul.dpUniSlider_nav li")[c]).addClass("active")}if(typeof this.settings.onSlideBeforeMove==="function"&&!this.firstSlide){this.settings.onSlideBeforeMove()}this.no_draggable=true;var n=this;this.$currentSlide.css("zIndex","3").animate({left:-g+"px"},this.settings.slideTransitionSpeed).animate(k,this.settings.slideTransitionSpeed,function(){b.prototype._currentSlideTransition(n);n.$nextSlide.css({left:-j+"px",zIndex:"4",visibility:"visible"}).animate(l,n.settings.slideTransitionSpeed).animate({left:"0"},n.settings.slideTransitionSpeed,function(){n._nextSlideTransition(m)})})},_currentSlideTransition:function(b){a(b.$slides).css("visibility","hidden");if(b.settings.autoSlide&&b.settings.showAutoSlideIcon){b.$autoLoader_icon.fadeOut("fast")}b.outerHeight=0;a(b.$nextSlide).children().each(function(a){b._loadChildrenAnimations(a,this,b)});if(b.settings.fixedHeight!=""&&b.settings.fixedHeight>0){b.$container.height(b.settings.fixedHeight);b.$slides.height(b.settings.fixedHeight)}else{b.changeContainerHeight(b.$nextSlide)}b.$currentSlide.css("left",b.windowWidth+"px")},_nextSlideTransition:function(b){var c=this;this.$nextSlide.css("visibility","visible");this.$currentSlide=this.$nextSlide;this.clearAutoTimer();this.no_draggable=false;this.setAutoAnimation();if(typeof this.settings.onSlideAfterMove==="function"&&!this.firstSlide){this.settings.onSlideAfterMove()}this.$pauseHoverElement.unbind("mouseenter mouseleave");if(!b&&this.settings.autoSlide&&this.settings.showAutoSlideIcon){this.$autoLoader_icon.fadeIn("fast");if(this.settings.pauseOnHover){this.$pauseHoverElement.hover(function(){a(this).addClass("dpUniSlider_ishovered");if(c.settings.showAutoSlideIcon){if(c.$autoLoader_icon.is(":animated")){c.$autoLoader_icon.stop().css("display","none");return}c.$autoLoader_icon.stop().fadeOut("fast")}},function(){a(this).removeClass("dpUniSlider_ishovered");if(c.settings.showAutoSlideIcon){if(c.$autoLoader_icon.is(":animated")){c.$autoLoader_icon.stop().css({display:"block",opacity:"1"});return}c.$autoLoader_icon.stop().fadeIn("fast")}})}}this.firstSlide=false},_loadChildrenAnimations:function(b,c,d){var e=a(c).data("unislider-settings");var f=typeof e!=="undefined"?d.addPx(e.left):"";var g=typeof e!=="undefined"?d.addPx(e.right):"";var h=typeof e!=="undefined"?d.addPx(e.top):"";var i=typeof e!=="undefined"?e.align:"";var j=typeof e!=="undefined"?d.addPx(e.width):"";var k=d.settings.elementsDelayTransitionSpeed;a(c).not("span.dpUniSlider_caption").css({position:"absolute",display:"block",top:0});if(f=="center"){a(c).css({left:-a(c).width()+"px",opacity:0});if(d.settings.elementsDelayTransition){a(c).delay(k*b).animate({left:"50%",marginLeft:-(a(c).outerWidth()/2)+"px",opacity:1},1e3)}else{a(c).css({left:"50%",marginLeft:-(a(c).outerWidth()/2)+"px",opacity:1})}}else if(f!=""&&typeof f!="undefined"){a(c).css({left:-a(c).width()+"px",opacity:0});if(d.settings.elementsDelayTransition){a(c).delay(k*b).animate({left:f,opacity:1},1e3)}else{a(c).css({left:f,opacity:1})}}if(g=="center"){a(c).css("right",-a(c).width()+"px");if(d.settings.elementsDelayTransition){a(c).delay(k*b).animate({right:"50%",marginRight:-(a(c).outerWidth()/2)+"px"},1e3)}else{a(c).css({right:"50%",marginRight:-(a(c).outerWidth()/2)+"px"})}}else if(g!=""&&typeof g!="undefined"){a(c).css("right",-a(c).width()+"px");if(d.settings.elementsDelayTransition){a(c).delay(k*b).animate({right:g},1e3)}else{a(c).css({right:g})}}if(h!=""){a(c).css("top",h)}if(j!=""){a(c).css("width",j)}if(i!=""){a(c).css("text-align",i)}if(a(c).outerHeight()+parseInt(a(c).css("top").replace("px",""),10)>d.outerHeight){d.outerHeight=a(c).outerHeight()+parseInt(a(c).css("top").replace("px",""),10)}a(d.$nextSlide).height(d.outerHeight)},changeContainerHeight:function(b,c){var d=b.innerHeight(),e=this.$container.innerHeight();if(e===d){if(c instanceof Function)c.call(this);return}a(this.$container).animate({height:d},"fast",function(){if(c instanceof Function)c.call(this)})},setAutoAnimation:function(){if(this.settings.autoSlide){var a=this;this.animateTimer=setTimeout(function(){a.autoNext(a)},this.settings.autoSlideSpeed)}},clearAutoTimer:function(){if(this.settings.autoSlide&&typeof this.animateTimer!=="undefined")clearTimeout(this.animateTimer)},autoNext:function(a){a.goToSlide(a.currentSlideNum+1,true)},addPx:function(a){if(a!=""&&!isNaN(a)){a+="px"}return a},startDrag:function(b){if(!this.isDragging){var c;if(this.hasTouch){var d=b.originalEvent.touches;if(d&&d.length>0){c=d[0]}else{return false}}else{c=b;if(b.target)el=b.target;else if(b.srcElement)el=b.srcElement;if(el.toString()!=="[object HTMLEmbedElement]"){b.preventDefault()}}this.isDragging=true;var e=this;a(document).bind(this.moveEvent,function(a){if(!e.hasTouch){a.preventDefault()}e.moveDrag(a)});a(document).bind(this.upEvent,function(a){e.releaseDrag(a)});startPos=this.tx=parseInt(this.$slides.css("left"),10);this.successfullyDragged=false;this.accelerationX=this.tx;this.startTime=b.timeStamp||(new Date).getTime();this.startMouseX=c.clientX;this.startMouseY=c.clientY}return false},moveDrag:function(a){var b;if(this.hasTouch){var c=a.originalEvent.touches;if(c.length>1){return false}b=c[0];a.preventDefault()}else{b=a;a.preventDefault()}this.lastDragPosition=this.currentDragPosition;var d=b.clientX-this.startMouseX;if(this.lastDragPosition!=d){this.currentDragPosition=d}if(d!=0){if(!this.settings.loop){if(this.currentSlideNum==0){if(d>0){d=Math.sqrt(d)*5}}else if(this.currentSlideNum==this.slidesTotal-1){if(d<0){d=-Math.sqrt(-d)*5}}}if(typeof this.settings.onDrag==="function"){this.settings.onDrag()}this.$container.addClass("isDragging");this.$slides.css("left",d)}var e=a.timeStamp||(new Date).getTime();if(e-this.startTime>350){this.startTime=e;this.accelerationX=this.tx+d}return false},releaseDrag:function(b){if(this.isDragging){var c=this;this.isDragging=false;this.$container.removeClass("isDragging");var d=parseInt(this.$slides.css("left"),10);a(document).unbind(this.moveEvent).unbind(this.upEvent);if(d==this._startPos){this.successfullyDragged=false;return}else{this.successfullyDragged=true}var e=this.accelerationX-d;var f=Math.max(40,(b.timeStamp||(new Date).getTime())-this.startTime);var g=Math.abs(e)/f;var h=this.$slides.width()-Math.abs(startPos-d);var i=Math.max(h*1.08/g,200);i=Math.min(i,600);function j(){h=Math.abs(startPos-d);i=Math.max(h*1.08/g,200);i=Math.min(i,500);a(c.$slides).animate({left:0},"fast")}if(typeof this.settings.onDragRelease==="function"){this.settings.onDragRelease()}if(startPos-this.settings.dragOffset>d){if(this.lastDragPosition<this.currentDragPosition||!this.settings.loop&&this.currentSlideNum==this.slidesTotal-1){j();return false}this.goToSlide(this.currentSlideNum+1)}else if(startPos+this.settings.dragOffset<d){if(this.lastDragPosition>this.currentDragPosition||!this.settings.loop&&this.currentSlideNum==0){j();return false}this.goToSlide(this.currentSlideNum-1)}else{j()}}return false}};a.fn.dpUniSlider=function(c){return this.each(function(){var d=new b(a(this),c);a(this).data("dpUniSlider",d)})};a.fn.dpUniSlider.defaults={autoSlideSpeed:5e3,autoSlide:false,pauseOnHover:false,showAutoSlideIcon:true,loop:true,showArrows:true,showNavigation:true,draggable:true,navPosition:"bottom-center",fixedHeight:"",preselectSlideNum:0,elementsDelayTransition:true,elementsDelayTransitionSpeed:500,slideTransitionSpeed:200,startOffset:110,endOffset:80,dragOffset:50,slideOpacity:800,onSlideBeforeMove:function(){},onSlideAfterMove:function(){},onSlidePrev:function(){},onSlideNext:function(){},onDrag:function(){},onDragRelease:function(){}};a.fn.dpUniSlider.settings={}})(jQuery)